## *FeatureDecoupling Training and Linear Evaluation*

### License

This part of the code is released under the MIT License (refer to the LICENSE file for details).

### Requirements

* python 3.6.5
* [pytorch](http://pytorch.org/) 1.0
* [torchnet](https://github.com/pytorch/tnt)
* [tqdm](https://github.com/tqdm/tqdm)

### Before running the experiments

* Note that all the experiment configuration files are placed in the [config](https://github.com/philiptheother/FeatureDecoupling/tree/master/pytorch_feature_decoupling/config) directory.

* The PU probabilities of each training instances should be stored in the file *prob.dat* and placed under the directory of [prob](https://github.com/philiptheother/FeatureDecoupling/tree/master/_experiments/ImageNet_Decoupling_AlexNet/prob). For those instances originated from ImageNet training set, this file can be downloaded from [prob.dat](https://mega.nz/#!brBVnQbK!AU2P0D1yh4L1V9aqP3LYsWaG464q3SD-yRg5BZ7st8c). If you want to use PU module in FeatureDecoupling for your own dataset, you have to first train a [RotNet](https://github.com/gidariss/FeatureLearningRotNet) on your dataset and predict instance probabilities. This prediction is better to be estimated out-of-sample to avoid over-fitting.

### Usage

Specify the number of data loading workers (--num_workers) and display steps intervals (--disp_step) according to your own preferences.

* Train a FeatureDecoupling model (with AlexNet architecture) on ImageNet training set:  
`python main.py --exp=ImageNet_Decoupling_AlexNet --evaluate 0`

* Train & evaluate linear classifiers for the ImageNet task on the feature maps generated by the convolutional layers (i.e., conv1, conv2, conv3, conv4, and conv5) of the pre-trained FeatureDecoupling model:  
`python main.py --exp=ImageNet_LinearClassifiers_ImageNet_Decoupling_AlexNet_Features --evaluate 0`

* Train & evaluate linear classifiers for the Places205 task on the feature maps generated by the convolutional layers (i.e., conv1, conv2, conv3, conv4, and conv5) of the pre-trained FeatureDecoupling model:  
`python main.py --exp=Places205_LinearClassifiers_ImageNet_Decoupling_AlexNet_Features --evaluate 0`

* Train & evaluate non-linear classifiers for the ImageNet task on the feature maps generated by the conv4 and conv5 convolutional layers of the pre-trained FeatureDecoupling model:  
`python main.py --exp=ImageNet_NonLinearClassifiers_ImageNet_Decoupling_AlexNet_Features --evaluate 0`

### Acknowledgment

* Some of our codes in pytorch_feature_decoupling reuse the github project [FeatureLearningRotNet](https://github.com/gidariss/FeatureLearningRotNet) and project [lemniscate.pytorch](https://github.com/zhirongw/lemniscate.pytorch).